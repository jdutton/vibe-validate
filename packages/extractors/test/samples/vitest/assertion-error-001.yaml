$schema: ../sample-schema.json

# Basic Vitest assertion failure - most common pattern

metadata:
  tool: vitest
  toolVersion: "3.2.4"
  platform: linux
  nodeVersion: "22.0.0"
  contributor: vibe-validate
  contributedDate: "2025-10-22"
  sourceIssue: null
  sourcePR: null
  category: assertion-failure
  difficulty: easy
  description: |
    Standard vitest assertion failure with expect().
    Common pattern when a test assertion fails.
    Includes full test path, error message, and stack trace.

input:
  raw: |
    ❌ packages/core/test/runner.test.ts > ValidationRunner > should extract test failures

      AssertionError: expected 2 to equal 3

        Expected: 3
        Received: 2

        at Object.<anonymous> (packages/core/test/runner.test.ts:45:12)
        at Promise.then.completed (node_modules/vitest/dist/chunks/runtime.js:89:5)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

expected:
  detectionConfidence: 95
  detectedTool: vitest
  failures:
    - tool: vitest
      type: test-failure
      summary: "ValidationRunner > should extract test failures"
      message: "AssertionError: expected 2 to equal 3"
      location:
        file: packages/core/test/runner.test.ts
        line: 45
        column: 12
      context: |
        Expected: 3
        Received: 2
      stackTrace:
        - file: packages/core/test/runner.test.ts
          line: 45
          column: 12
          function: "Object.<anonymous>"
        - file: node_modules/vitest/dist/chunks/runtime.js
          line: 89
          column: 5
          function: "Promise.then.completed"
        - file: node:internal/process/task_queues
          line: 95
          column: 5
          function: "processTicksAndRejections"
      relevance: 100

      # What users see - terse and actionable
      llmSummary: |
        Test 'ValidationRunner > should extract test failures' failed in packages/core/test/runner.test.ts:45
        AssertionError: expected 2 to equal 3 (received 2, expected 3)

quality:
  # Auto-generated by test runs
  lastTested: null
  fields: {}
  score: null
  issues: []
  scoreHistory: []

improvementHints:
  - "Look for '>' separators in test path to build full suite > test hierarchy"
  - "Parse 'Expected:' and 'Received:' lines for assertion context"
  - "Stack trace ends at separator line (⎯⎯⎯) or blank line"
  - "First stack frame usually has the actual error location"

relatedSamples:
  - vitest/assertion-error-002.yaml
