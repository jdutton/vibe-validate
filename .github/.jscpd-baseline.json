{
  "duplicates": [
    {
      "format": "typescript",
      "lines": 9,
      "fragment": "function extractFailures(output: string): TestFailureInfo[] {\n  const failures: TestFailureInfo[] = [];\n  const lines = output.split('\\n');\n\n  let i = 0;\n  while (i < lines.length) {\n    const line = lines[i];\n\n    // Look for numbered failure markers (e.g., \"1) Test name\")",
      "tokens": 0,
      "firstFile": {
        "name": "packages/extractors/src/extractors/jasmine/index.ts",
        "start": 21,
        "end": 29,
        "startLoc": {
          "line": 21,
          "column": 1,
          "position": 55
        },
        "endLoc": {
          "line": 29,
          "column": 60,
          "position": 144
        }
      },
      "secondFile": {
        "name": "packages/extractors/src/extractors/mocha/index.ts",
        "start": 21,
        "end": 29,
        "startLoc": {
          "line": 21,
          "column": 1,
          "position": 55
        },
        "endLoc": {
          "line": 29,
          "column": 53,
          "position": 144
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": "], 10) : 0;\n\n  // Extract all failures\n  const failures = extractFailures(output);\n\n  // Early return if no failures detected (but failure count suggested there should be)\n  if (failureCount === 0 && failures.length === 0) {\n    return processTestFailures([], 95);\n  }\n\n  // Process failures using shared utility\n  return processTestFailures(failures, 95);\n}\n\n/**\n * Detect if output is from Jasmine test framework\n *\n * @param output - Command output to analyze\n * @returns Detection result with confidence and patterns\n */",
      "tokens": 0,
      "firstFile": {
        "name": "packages/extractors/src/extractors/jasmine/index.ts",
        "start": 160,
        "end": 179,
        "startLoc": {
          "line": 160,
          "column": 2,
          "position": 1104
        },
        "endLoc": {
          "line": 179,
          "column": 4,
          "position": 1194
        }
      },
      "secondFile": {
        "name": "packages/extractors/src/extractors/mocha/index.ts",
        "start": 174,
        "end": 193,
        "startLoc": {
          "line": 174,
          "column": 2,
          "position": 1084
        },
        "endLoc": {
          "line": 193,
          "column": 4,
          "position": 1174
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ",\n          confidence: detection.confidence,\n          patterns: detection.patterns,\n          reason: detection.reason,\n        },\n        confidence: 100,\n        completeness: 100,\n        issues: [],\n      },\n    };\n  }\n\n  const errors: FormattedError[] = [];\n  let completeCount = 0;\n\n  for (const failure of failures) {\n    const file = failure.file ?? 'unknown'",
      "tokens": 0,
      "firstFile": {
        "name": "packages/extractors/src/extractors/ava/index.ts",
        "start": 164,
        "end": 180,
        "startLoc": {
          "line": 164,
          "column": 6,
          "position": 1021
        },
        "endLoc": {
          "line": 180,
          "column": 10,
          "position": 1144
        }
      },
      "secondFile": {
        "name": "packages/extractors/src/extractors/tap/index.ts",
        "start": 158,
        "end": 174,
        "startLoc": {
          "line": 158,
          "column": 6,
          "position": 988
        },
        "endLoc": {
          "line": 174,
          "column": 10,
          "position": 1111
        }
      }
    },
    {
      "format": "typescript",
      "lines": 24,
      "fragment": ",\n      confidence: detection.confidence,\n      patterns: detection.patterns,\n      reason: detection.reason,\n    },\n    confidence,\n    completeness,\n    issues: [],\n  };\n\n  return {\n    summary,\n    errors,\n    totalErrors: failures.length,\n    errorSummary: formatCleanOutput(errors),\n    guidance,\n    metadata,\n  };\n}\n\n/**\n * Extract all failures from Ava output\n * Strategy: Find detailed headers (test names with ›), then parse each block\n */",
      "tokens": 0,
      "firstFile": {
        "name": "packages/extractors/src/extractors/ava/index.ts",
        "start": 211,
        "end": 234,
        "startLoc": {
          "line": 211,
          "column": 6,
          "position": 1417
        },
        "endLoc": {
          "line": 234,
          "column": 4,
          "position": 1518
        }
      },
      "secondFile": {
        "name": "packages/extractors/src/extractors/tap/index.ts",
        "start": 204,
        "end": 226,
        "startLoc": {
          "line": 204,
          "column": 6,
          "position": 1362
        },
        "endLoc": {
          "line": 226,
          "column": 4,
          "position": 1463
        }
      }
    },
    {
      "format": "javascript",
      "lines": 18,
      "fragment": ");\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  blue: '\\x1b[0;34m',\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n/**\n * Package publishing order (dependency-order)\n */",
      "tokens": 0,
      "firstFile": {
        "name": "tools/publish-with-rollback.js",
        "start": 40,
        "end": 57,
        "startLoc": {
          "line": 40,
          "column": 25,
          "position": 146
        },
        "endLoc": {
          "line": 57,
          "column": 4,
          "position": 242
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 26,
        "end": 41,
        "startLoc": {
          "line": 26,
          "column": 5,
          "position": 100
        },
        "endLoc": {
          "line": 41,
          "column": 32,
          "position": 196
        }
      }
    },
    {
      "format": "javascript",
      "lines": 14,
      "fragment": "} from 'node:fs';\nimport { join , dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\nconst PROJECT_ROOT = join(__dirname, '..');\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  reset",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check.js",
        "start": 21,
        "end": 34,
        "startLoc": {
          "line": 21,
          "column": 2,
          "position": 39
        },
        "endLoc": {
          "line": 34,
          "column": 6,
          "position": 153
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 20,
        "end": 33,
        "startLoc": {
          "line": 20,
          "column": 2,
          "position": 23
        },
        "endLoc": {
          "line": 33,
          "column": 5,
          "position": 136
        }
      }
    },
    {
      "format": "javascript",
      "lines": 11,
      "fragment": ",\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n// Parse command-line arguments\nconst args = process.argv.slice(2);\nlet",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check.js",
        "start": 33,
        "end": 43,
        "startLoc": {
          "line": 33,
          "column": 13,
          "position": 150
        },
        "endLoc": {
          "line": 43,
          "column": 4,
          "position": 224
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 33,
        "end": 44,
        "startLoc": {
          "line": 33,
          "column": 13,
          "position": 140
        },
        "endLoc": {
          "line": 44,
          "column": 3,
          "position": 215
        }
      }
    },
    {
      "format": "javascript",
      "lines": 26,
      "fragment": "import { safeExecSync } from '../packages/utils/dist/safe-exec.js';\nimport { readdirSync, existsSync, readFileSync } from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\nconst PROJECT_ROOT = join(__dirname, '..');\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  blue: '\\x1b[0;34m',\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n// Parse command-line arguments\nconst args = process.argv.slice(2);\n\nif (args[",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check-ci.js",
        "start": 26,
        "end": 51,
        "startLoc": {
          "line": 26,
          "column": 1,
          "position": 14
        },
        "endLoc": {
          "line": 51,
          "column": 2,
          "position": 235
        }
      },
      "secondFile": {
        "name": "tools/pre-publish-check.js",
        "start": 20,
        "end": 44,
        "startLoc": {
          "line": 20,
          "column": 1,
          "position": 14
        },
        "endLoc": {
          "line": 44,
          "column": 2,
          "position": 219
        }
      }
    },
    {
      "format": "javascript",
      "lines": 9,
      "fragment": "try {\n  safeExecSync('git', ['rev-parse', '--git-dir'], { stdio: 'pipe', cwd: PROJECT_ROOT });\n  log('✓ Git repository detected', 'green');\n} catch (_error) { // NOSONAR - Exception handled by logging and exiting\n  log('✗ Not a git repository', 'red');\n  process.exit(1);\n}\n\n// Check 2: Run validation",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check-ci.js",
        "start": 73,
        "end": 81,
        "startLoc": {
          "line": 73,
          "column": 1,
          "position": 305
        },
        "endLoc": {
          "line": 81,
          "column": 27,
          "position": 384
        }
      },
      "secondFile": {
        "name": "tools/pre-publish-check.js",
        "start": 80,
        "end": 88,
        "startLoc": {
          "line": 80,
          "column": 1,
          "position": 450
        },
        "endLoc": {
          "line": 88,
          "column": 27,
          "position": 529
        }
      }
    },
    {
      "format": "javascript",
      "lines": 14,
      "fragment": "console.log('');\nconsole.log('Running validation checks...');\n\ntry {\n  safeExecSync('pnpm', ['validate'], { stdio: 'inherit', cwd: PROJECT_ROOT });\n  log('✓ All validation checks passed', 'green');\n} catch (_error) { // NOSONAR - Exception handled by logging and exiting\n  console.log('');\n  log('✗ Validation failed', 'red');\n  console.log('  Check the output above and fix all issues before publishing');\n  process.exit(1);\n}\n\n// Check 3: Packages are built",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check-ci.js",
        "start": 82,
        "end": 95,
        "startLoc": {
          "line": 82,
          "column": 1,
          "position": 386
        },
        "endLoc": {
          "line": 95,
          "column": 31,
          "position": 497
        }
      },
      "secondFile": {
        "name": "tools/pre-publish-check.js",
        "start": 175,
        "end": 188,
        "startLoc": {
          "line": 175,
          "column": 1,
          "position": 1233
        },
        "endLoc": {
          "line": 188,
          "column": 31,
          "position": 1344
        }
      }
    },
    {
      "format": "javascript",
      "lines": 43,
      "fragment": "console.log('');\nconsole.log('Checking package builds...');\n\nconst packagesDir = join(PROJECT_ROOT, 'packages');\nconst missingBuilds = [];\n\ntry {\n  const packages = readdirSync(packagesDir, { withFileTypes: true })\n    .filter(dirent => dirent.isDirectory())\n    .map(dirent => dirent.name);\n\n  for (const pkg of packages) {\n    // Check if package is private (skip build check for private packages)\n    const pkgJsonPath = join(packagesDir, pkg, 'package.json');\n    if (existsSync(pkgJsonPath)) {\n      const pkgJson = JSON.parse(readFileSync(pkgJsonPath, 'utf8'));\n\n      // Skip private packages (like test beds)\n      if (pkgJson.private) {\n        continue;\n      }\n\n      // Skip umbrella package (vibe-validate) - it's just a wrapper with bin scripts\n      if (pkg === 'vibe-validate') {\n        continue;\n      }\n    }\n\n    const distDir = join(packagesDir, pkg, 'dist');\n    if (!existsSync(distDir)) {\n      missingBuilds.push(`packages/${pkg}/`);\n    }\n  }\n} catch (err) {\n  log('✗ Failed to check package builds', 'red');\n  console.error(err.message);\n  process.exit(1);\n}\n\nif (missingBuilds.length > 0) {\n  log('✗ Missing build outputs', 'red');\n  for (const pkg of missingBuilds) console.log(pkg);\n  console.log('  Run \\'pnpm -r build\\' to build all packages'",
      "tokens": 0,
      "firstFile": {
        "name": "tools/pre-publish-check-ci.js",
        "start": 96,
        "end": 138,
        "startLoc": {
          "line": 96,
          "column": 1,
          "position": 499
        },
        "endLoc": {
          "line": 138,
          "column": 48,
          "position": 862
        }
      },
      "secondFile": {
        "name": "tools/pre-publish-check.js",
        "start": 189,
        "end": 231,
        "startLoc": {
          "line": 189,
          "column": 1,
          "position": 1346
        },
        "endLoc": {
          "line": 231,
          "column": 45,
          "position": 1709
        }
      }
    },
    {
      "format": "javascript",
      "lines": 8,
      "fragment": "} from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\nconst PROJECT_ROOT = join(__dirname, '..');\nconst",
      "tokens": 0,
      "firstFile": {
        "name": "tools/generate-cli-docs.js",
        "start": 18,
        "end": 25,
        "startLoc": {
          "line": 18,
          "column": 2,
          "position": 39
        },
        "endLoc": {
          "line": 25,
          "column": 6,
          "position": 119
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 20,
        "end": 28,
        "startLoc": {
          "line": 20,
          "column": 2,
          "position": 23
        },
        "endLoc": {
          "line": 28,
          "column": 21,
          "position": 104
        }
      }
    },
    {
      "format": "javascript",
      "lines": 8,
      "fragment": "} from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\nconst PROJECT_ROOT = join(__dirname, '..');\nconst CHANGELOG_PATH",
      "tokens": 0,
      "firstFile": {
        "name": "tools/extract-changelog.js",
        "start": 23,
        "end": 30,
        "startLoc": {
          "line": 23,
          "column": 2,
          "position": 23
        },
        "endLoc": {
          "line": 30,
          "column": 15,
          "position": 105
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 20,
        "end": 25,
        "startLoc": {
          "line": 20,
          "column": 2,
          "position": 23
        },
        "endLoc": {
          "line": 25,
          "column": 8,
          "position": 121
        }
      }
    },
    {
      "format": "javascript",
      "lines": 21,
      "fragment": ");\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  blue: '\\x1b[0;34m',\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n/**\n * Extract version section from CHANGELOG\n * @param {string} changelogContent - Full CHANGELOG content\n * @param {string} version - Version to extract (e.g., '0.17.5')\n * @returns {string} - Extracted content for the version\n */",
      "tokens": 0,
      "firstFile": {
        "name": "tools/extract-changelog.js",
        "start": 31,
        "end": 51,
        "startLoc": {
          "line": 31,
          "column": 24,
          "position": 130
        },
        "endLoc": {
          "line": 51,
          "column": 4,
          "position": 226
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 26,
        "end": 41,
        "startLoc": {
          "line": 26,
          "column": 5,
          "position": 100
        },
        "endLoc": {
          "line": 41,
          "column": 32,
          "position": 196
        }
      }
    },
    {
      "format": "javascript",
      "lines": 20,
      "fragment": ";\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  blue: '\\x1b[0;34m',\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n/**\n * Output GitHub Actions output variable\n * @param {string} name - Variable name\n * @param {string} value - Variable value\n */",
      "tokens": 0,
      "firstFile": {
        "name": "tools/determine-publish-tags.js",
        "start": 28,
        "end": 47,
        "startLoc": {
          "line": 28,
          "column": 9,
          "position": 47
        },
        "endLoc": {
          "line": 47,
          "column": 4,
          "position": 142
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 26,
        "end": 41,
        "startLoc": {
          "line": 26,
          "column": 2,
          "position": 101
        },
        "endLoc": {
          "line": 41,
          "column": 32,
          "position": 196
        }
      }
    },
    {
      "format": "javascript",
      "lines": 14,
      "fragment": "function getNpmTagVersion(packageName, tag) {\n  const result = safeExecResult('npm', ['view', `${packageName}@${tag}`, 'version'], {\n    encoding: 'utf8',\n    stdio: 'pipe',\n  });\n\n  if (result.status === 0 && result.stdout) {\n    return result.stdout.trim();\n  }\n\n  return null;\n}\n\n// Parse command-line arguments",
      "tokens": 0,
      "firstFile": {
        "name": "tools/determine-publish-tags.js",
        "start": 64,
        "end": 77,
        "startLoc": {
          "line": 64,
          "column": 1,
          "position": 229
        },
        "endLoc": {
          "line": 77,
          "column": 32,
          "position": 340
        }
      },
      "secondFile": {
        "name": "tools/publish-with-rollback.js",
        "start": 109,
        "end": 124,
        "startLoc": {
          "line": 109,
          "column": 1,
          "position": 492
        },
        "endLoc": {
          "line": 124,
          "column": 4,
          "position": 603
        }
      }
    },
    {
      "format": "javascript",
      "lines": 48,
      "fragment": ", readdirSync } from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\nconst PROJECT_ROOT = join(__dirname, '..');\n\n// Colors for output\nconst colors = {\n  red: '\\x1b[0;31m',\n  green: '\\x1b[0;32m',\n  yellow: '\\x1b[1;33m',\n  blue: '\\x1b[0;34m',\n  reset: '\\x1b[0m',\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\n// Parse command-line arguments\nconst args = process.argv.slice(2);\n\nif (args.length === 0 || args[0] === '--help' || args[0] === '-h') {\n  console.log(`\nVersion Bump Script\n\nUpdates version in ALL package.json files (root + all workspace packages).\n\nUsage:\n  node tools/bump-version.js <version|increment>\n  pnpm bump-version <version|increment>\n\nArguments:\n  version      Explicit version (e.g., 0.14.2, 1.0.0)\n  increment    patch, minor, or major (auto-calculates from current version)\n\nExamples:\n  node tools/bump-version.js 0.14.2       # Set to explicit version\n  node tools/bump-version.js patch        # Increment patch (0.14.2 -> 0.14.3)\n  node tools/bump-version.js minor        # Increment minor (0.14.2 -> 0.15.0)\n  node tools/bump-version.js major        # Increment major (0.14.2 -> 1.0.0)\n\nExit codes:\n  0 - Success\n  1 - Error (invalid version, file not found, etc.)\n  `",
      "tokens": 0,
      "firstFile": {
        "name": "tools/bump-version.js",
        "start": 21,
        "end": 68,
        "startLoc": {
          "line": 21,
          "column": 14,
          "position": 22
        },
        "endLoc": {
          "line": 68,
          "column": 4,
          "position": 259
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 20,
        "end": 60,
        "startLoc": {
          "line": 20,
          "column": 13,
          "position": 19
        },
        "endLoc": {
          "line": 60,
          "column": 4,
          "position": 256
        }
      }
    },
    {
      "format": "javascript",
      "lines": 13,
      "fragment": "= 0;\nlet skippedCount = 0;\n\ntry {\n  const packages = readdirSync(packagesDir, { withFileTypes: true })\n    .filter(dirent => dirent.isDirectory())\n    .map(dirent => dirent.name)\n    .sort();\n\n  for (const pkg of packages) {\n    const pkgPath = join(packagesDir, pkg, 'package.json');\n    try {\n      const result = updatePackageVersion",
      "tokens": 0,
      "firstFile": {
        "name": "tools/bump-version.js",
        "start": 199,
        "end": 211,
        "startLoc": {
          "line": 199,
          "column": 2,
          "position": 1426
        },
        "endLoc": {
          "line": 211,
          "column": 21,
          "position": 1549
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 123,
        "end": 135,
        "startLoc": {
          "line": 123,
          "column": 2,
          "position": 745
        },
        "endLoc": {
          "line": 135,
          "column": 20,
          "position": 868
        }
      }
    },
    {
      "format": "javascript",
      "lines": 11,
      "fragment": ");\n      if (result.skipped) {\n        let reasonText;\n        if (result.reason === 'no-version') {\n          reasonText = 'no version field';\n        } else {\n          reasonText = result.version ? `${result.reason}, v${result.version}` : result.reason;\n        }\n        log(`  - ${result.name}: skipped (${reasonText})`, 'yellow');\n        skippedCount++;\n      } else if (result.updated",
      "tokens": 0,
      "firstFile": {
        "name": "tools/bump-version.js",
        "start": 211,
        "end": 221,
        "startLoc": {
          "line": 211,
          "column": 11,
          "position": 1555
        },
        "endLoc": {
          "line": 221,
          "column": 8,
          "position": 1675
        }
      },
      "secondFile": {
        "name": "tools/validate-version.js",
        "start": 135,
        "end": 146,
        "startLoc": {
          "line": 135,
          "column": 16,
          "position": 874
        },
        "endLoc": {
          "line": 146,
          "column": 6,
          "position": 995
        }
      }
    }
  ]
}